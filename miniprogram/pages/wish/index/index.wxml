<!--pages/wish/index/index.wxml-->
<view class="wish-container">
  <!-- æ„¿æœ›åˆ—è¡¨ -->
  <view class="wish-list" wx:if="{{wishes.length > 0}}">
    <view class="wish-card" wx:for="{{wishes}}" wx:key="_id">
      <view class="wish-header">
        <view class="wish-title-row">
          <text class="wish-title">{{item.title}}</text>
          <view class="status-badge status-{{item.status}}">
            {{item.status === 'pending' ? 'å¾…å®ç°' : item.status === 'approved' ? 'å·²è®¤å¯' : item.status === 'rejected' ? 'ä¸åšäº†' : 'å·²å®ç°'}}
          </view>
        </view>
        <text class="wish-creator">{{item.creator_name}}</text>
      </view>

      <view class="wish-desc" wx:if="{{item.description}}">
        {{item.description}}
      </view>

      <view class="wish-footer">
        <view class="vote-btn {{item.voted_by && item.voted_by.indexOf(userOpenid) > -1 ? 'voted' : ''}}" bindtap="onVote" data-id="{{item._id}}">
          <text class="vote-icon">{{item.voted_by && item.voted_by.indexOf(userOpenid) > -1 ? 'â¤ï¸' : 'ğŸ¤'}}</text>
          <text class="vote-count">{{item.vote_count || 0}}</text>
        </view>

        <view class="wish-actions">
          <text class="action-btn" bindtap="onEdit" data-id="{{item._id}}">ç¼–è¾‘</text>
          <text class="action-btn danger" bindtap="onDelete" data-id="{{item._id}}">åˆ é™¤</text>
        </view>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:else>
    <text class="empty-icon">ğŸ’­</text>
    <text class="empty-text">è¿˜æ²¡æœ‰æ„¿æœ›</text>
    <text class="empty-hint">è®¸ä¸ªæ„¿å§ï¼Œä¸‡ä¸€å®ç°äº†å‘¢</text>
  </view>

  <!-- åŠ è½½ä¸­ -->
  <view class="loading" wx:if="{{loading}}">
    <text>åŠ è½½ä¸­...</text>
  </view>

  <!-- æ·»åŠ æŒ‰é’® -->
  <view class="fab" bindtap="showAddDialog">+</view>

  <!-- æ·»åŠ å¼¹çª— -->
  <view class="dialog-mask" wx:if="{{showAddDialog}}" bindtap="hideAddDialog"></view>
  <view class="dialog" wx:if="{{showAddDialog}}">
    <view class="dialog-header">
      <text class="dialog-title">è®¸ä¸ªæ„¿</text>
      <text class="dialog-close" bindtap="hideAddDialog">Ã—</text>
    </view>
    <view class="dialog-body">
      <view class="form-item">
        <text class="form-label">æ„¿æœ›</text>
        <input class="form-input" placeholder="æƒ³åƒç‚¹ä»€ä¹ˆï¼Ÿ" value="{{newWish.title}}" bindinput="onTitleInput" maxlength="50"/>
      </view>
      <view class="form-item">
        <text class="form-label">æè¿°</text>
        <textarea class="form-textarea" placeholder="è¯¦ç»†è¯´è¯´ï¼ˆæ¯”å¦‚ï¼šå°‘æ”¾è¾£ã€è¦åŠ é¦™èœï¼‰" value="{{newWish.description}}" bindinput="onDescInput" maxlength="200"/>
      </view>
    </view>
    <view class="dialog-footer">
      <button class="btn-cancel" bindtap="hideAddDialog">å–æ¶ˆ</button>
      <button class="btn-confirm" bindtap="submitWish">è®¸æ„¿</button>
    </view>
  </view>
</view>
