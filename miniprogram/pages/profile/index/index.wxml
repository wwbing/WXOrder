<!--pages/profile/index/index.wxml-->
<view class="profile-container">
  
  <!-- 1. Immersive Header -->
  <view class="profile-header">
    <view class="slogan-row">
      <text class="slogan-text">伏家私房菜，满足你的味蕾</text>
    </view>
    
    <view class="user-row" bindtap="handleUserLogin">
      <image class="avatar" src="{{userInfo.avatar_url || defaultAvatar}}" mode="aspectFill" />
      <view class="user-info">
        <view class="nickname-row">
           <text class="nickname">{{userInfo.nickname || '点击登录'}}</text>
           <view class="role-badge" wx:if="{{userInfo}}">
             {{ userInfo.role === 'chef' ? '大厨' : '吃货' }}
           </view>
        </view>
        <text class="uid-text" wx:if="{{userInfo}}">UID: {{userInfo._id}}</text>
        <text class="uid-text" wx:else>登录后同步数据</text>
      </view>
      <text class="arrow-right">></text>
    </view>
  </view>

  <!-- 2. Main Content Body -->
  <view class="content-body">
    
    <!-- Role Switch -->
    <view class="role-switch-card" wx:if="{{userInfo}}">
      <view class="switch-row">
        <text class="switch-label">我是大厨</text>
        <switch checked="{{userInfo.role === 'chef'}}" bindchange="onRoleSwitch" color="#07c160" />
      </view>
      <view class="switch-hint">切换后可以接单做菜哦~</view>
    </view>

    <!-- Stats Cards (Public Area) -->
    <view class="stats-section">
      <view class="section-title">吃货周报</view>
      
      <view class="stats-grid">
        <view class="stat-card">
          <view class="stat-icon">🍽️</view>
          <view class="stat-value">{{stats.totalMeals || 0}}</view>
          <view class="stat-label">总顿数</view>
        </view>
        
        <view class="stat-card">
          <view class="stat-icon">❤️</view>
          <view class="stat-value">{{stats.favDish || '暂无'}}</view>
          <view class="stat-label">最爱</view>
        </view>
        
        <view class="stat-card" wx:if="{{userInfo.role === 'chef'}}">
          <view class="stat-icon">🌈</view>
          <view class="stat-value">{{stats.praiseCount || 0}}</view>
          <view class="stat-label">彩虹屁</view>
        </view>
      </view>
    </view>

    <!-- Wishing Well -->
    <view class="wishing-well-card" bindtap="goToWishingWell">
      <view class="wish-icon">💭</view>
      <view class="wish-content">
        <text class="wish-title">许愿池</text>
        <text class="wish-desc">告诉大厨你想吃什么</text>
      </view>
      <text class="arrow">></text>
    </view>

    <!-- 许愿池管理 -->
    <view class="wishing-well-card" bindtap="goToWishManage">
      <view class="wish-icon">📋</view>
      <view class="wish-content">
        <text class="wish-title">许愿池管理</text>
        <text class="wish-desc">查看和管理所有愿望</text>
      </view>
      <text class="arrow">></text>
    </view>

    <!-- Chef Zone (Only for Chefs) -->
    <view class="chef-zone" wx:if="{{userInfo.role === 'chef'}}">
      <view class="section-title">大厨专区</view>
      
      <view class="action-list">
        <view class="action-item" bindtap="goToKitchenEdit">
          <view class="action-icon" style="background:#e8fdf5; color:#07c160;">🏠</view>
          <view class="action-info">
            <text class="action-name">厨房设置</text>
            <text class="action-desc">修改名称、背景等</text>
          </view>
          <text class="arrow">></text>
        </view>

        <view class="action-item" bindtap="goToMenuManage">
          <view class="action-icon" style="background:#fff1f0; color:#f5222d;">📋</view>
          <view class="action-info">
            <text class="action-name">菜单管理</text>
            <text class="action-desc">添加、编辑菜品</text>
          </view>
          <text class="arrow">></text>
        </view>

        <view class="action-item" bindtap="goToOrderManage">
          <view class="action-icon" style="background:#e6f7ff; color:#1890ff;">📦</view>
          <view class="action-info">
            <text class="action-name">订单管理</text>
            <text class="action-desc">查看、删除订单</text>
          </view>
          <text class="arrow">></text>
        </view>

        <view class="action-item" bindtap="goToPraiseHistory">
          <view class="action-icon" style="background:#fff7e6; color:#fa8c16;">🌈</view>
          <view class="action-info">
            <text class="action-name">彩虹屁历史</text>
            <text class="action-desc">查看收到的夸奖</text>
          </view>
          <text class="arrow">></text>
        </view>
      </view>
    </view>

    <!-- Settings / Logout -->
    <view class="settings-section">
      <button class="btn-logout" bindtap="handleLogout">退出登录</button>
    </view>

  </view>

</view>
